config {
    type: "assertion",
}

SELECT
  CURRENT_DATETIME('Asia/Bangkok') AS process_time,
  "gender" AS field_name,
  gender AS value,
  REPLACE("${ref("cds_mdc_2_4", "customer_entity")}", '`', '') AS source_table,
  COUNT(*) cnt_id,
  COUNT(DISTINCT entity_id) unq_cnt_id
FROM
  ${ref("cds_mdc_2_4", "customer_entity")}
GROUP BY
  1,
  2,
  3,
  4
